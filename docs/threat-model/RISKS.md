# Реестр Рисков

| ID | Поток / элемент | Описание риска | L | I | Risk (L×I) | Стратегия | Владелец | Срок | План обработки / критерий закрытия |
|----|-----------------|----------------|---|---|-------------|-----------|----------|------|------------------------------------|
| R1 | F1 (Product Manager → Reverse Proxy) | Неправильная настройка TLS/сертификатов ведёт к MITM и утечке токенов | 2 | 5 | 10 | Снизить | DevOps Lead | 2024-05-15 | Обновление ingress с автоматической ротацией сертификатов, отчёт SSL Labs ≥ A (ссылка в CI) |
| R2 | F2 (Reverse Proxy → FastAPI) | Сервис без проверки mTLS получает доступ к внутреннему API и выполняет несанкционированные мутации | 3 | 5 | 15 | Снизить | Platform Engineer | 2024-04-30 | Включён mutual TLS, интеграционные тесты авторизации обязательны в CI, конфигурация хранится в IaC |
| R3 | F3/F4 (FastAPI ↔ Item Store) | SQL-инъекция через некорректную валидацию позволяет изменить все записи | 2 | 4 | 8 | Снизить | Backend Lead | 2024-04-12 | Pydantic схемы обязательны, `semgrep` покрывает паттерн без параметризации, unit-тесты добавлены |
| R4 | FastAPI Application (элемент) | Отсутствие rate limiting делает сервис уязвимым к DoS и истощению ресурсов | 3 | 4 | 12 | Снизить | SRE | 2024-05-01 | Включён rate-limiter на ingress (60 req/min/IP), k6 нагрузочный тест в nightly и в отчёте CI |
| R5 | F5/F6 (API ответы) | Утечка данных из-за отсутствия защитных заголовков и кеширования | 2 | 3 | 6 | Снизить | Backend Lead | 2024-04-05 | CSP/HSTS заголовки добавлены в middleware, ZAP baseline фиксирует наличие; smoke тест в CI зелёный |
| R6 | F7 (Аудит-логирование) | Неполные или отсутствующие аудит-логи усложняют расследование и нарушают требования соответствия | 2 | 4 | 8 | Снизить | Security Analyst | 2024-04-19 | Настроен централизованный сбор JSON-логов, проверка pytest проходит, retention ≥ 90 дней документирован |
| R7 | F8 (Доступ аналитика к логам) | Неограниченный доступ к логам раскрывает чувствительные данные команде без необходимости | 2 | 4 | 8 | Снизить | Security Analyst | 2024-05-10 | Введён RBAC с read-only ролями, VPN whitelisting активен, IAM аудит отражён в отчёте GRC |
| R8 | F9 (Developer → Git Hosting) | Коммиты с секретами попадают в репозиторий и становятся доступными злоумышленнику | 3 | 4 | 12 | Снизить | Engineering Manager | 2024-04-08 | Включён `trufflehog` в обязательном CI-стадии, включены branch protection + секреты хранятся в Vault |
| R9 | F10 (Git Hosting → CI/CD Pipeline) | Отключение security-джобов позволяет влить уязвимый код в main | 2 | 5 | 10 | Снизить | DevOps Lead | 2024-04-15 | Статусы `pip-audit`/`semgrep` обязательны для merge; PR-шаблон требует ссылку на артефакты; CI зелёный |
| R10 | Data Boundary (Item Store + Backups) | Хранилище и бэкапы без шифрования приводят к утечке данных при краже носителя | 2 | 4 | 8 | Снизить | Infrastructure Lead | 2024-05-20 | Включено шифрование at rest + шифрованные бэкапы (AES-256), ежемесячный restore-тест фиксируется в отчёте |
